# 05 · Malware

## 1. Concepto general

El **malware (Malicious Software)** es cualquier programa creado para **dañar, interrumpir, robar o tomar control** de sistemas sin el consentimiento del usuario.
Puede propagarse mediante archivos, macros, scripts, descargas, USB, sitios web comprometidos o tráfico de red malicioso.

---

## 2. Tipos principales de malware

| Tipo                   | Descripción                                                                | Características clave                                            |
| ---------------------- | -------------------------------------------------------------------------- | ---------------------------------------------------------------- |
| **Virus**              | Se adjunta a archivos ejecutables y requiere acción humana para propagarse | Se activa al ejecutar el archivo; puede corromper o borrar datos |
| **Gusano (Worm)**      | Se propaga automáticamente sin interacción del usuario                     | Saturación de red y recursos                                     |
| **Troyano (Trojan)**   | Se disfraza de software legítimo                                           | Instala backdoors o RAT para control remoto                      |
| **Ransomware**         | Cifra archivos/sistemas y exige pago por su liberación                     | Alta criticidad; ejemplos: WannaCry, LockBit                     |
| **Rootkit**            | Se oculta en áreas profundas del sistema                                   | Manipula procesos para evitar detección                          |
| **Keylogger**          | Registra pulsaciones del teclado                                           | Robo de contraseñas y datos financieros                          |
| **Spyware**            | Monitorea y envía datos del usuario                                        | Puede incluir adware y trackers                                  |
| **Adware / Bloatware** | Muestra publicidad o instala software no deseado                           | Reduce rendimiento y aumenta riesgos                             |
| **Logic Bomb**         | Se activa cuando se cumple una condición                                   | Difícil de detectar hasta su ejecución                           |
| **Botnet / RAT**       | Red de dispositivos zombis controlados remotamente                         | DDoS, spam, minería ilegal                                       |

---

## 3. Técnicas y variantes de malware

| Tipo                  | Descripción                                                           |
| --------------------- | --------------------------------------------------------------------- |
| **Polimórfico**       | Cambia su firma o partes del código en cada ejecución                 |
| **Metamórfico**       | Reescribe su propio código manteniendo la función                     |
| **Fileless Malware**  | Se ejecuta en memoria usando herramientas legítimas (PowerShell, WMI) |
| **Stealth / Armored** | Oculta procesos, cifra código o evade análisis                        |
| **DLL Injection**     | Inserta código malicioso en procesos legítimos                        |
| **Zero-day Malware**  | Explota vulnerabilidades desconocidas y sin parche                    |

---

## 4. Indicadores de Compromiso (IoC)

* Consumo anormal de CPU, memoria o red
* Archivos cifrados, inaccesibles o con extensiones extrañas
* Programas desconocidos ejecutándose
* Antivirus deshabilitado o logs eliminados
* Errores de autenticación o bloqueo de cuentas
* Tráfico hacia dominios o IPs sospechosas (C2)
* Cambios inesperados en permisos o servicios del sistema

---

## 5. Medidas de mitigación

### Prevención

* Patching frecuente de OS y aplicaciones
* Antivirus/EDR/XDR con detección por comportamiento
* Principio de menor privilegio
* Allow-listing de aplicaciones
* Backups cifrados y offline
* Formación en phishing y descargas seguras

### Detección

* SIEM, correlación de logs y alertas automáticas
* Threat Intelligence Feeds
* File Integrity Monitoring (FIM)

### Respuesta

* Aislar el sistema comprometido
* Conservar evidencias (disco y RAM)
* Activar CSIRT/CIRT
* Erradicar y reinstalar desde medios confiables
* Validar remediación con análisis posterior
